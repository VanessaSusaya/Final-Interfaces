<div class="dashboard-container">
  <!-- Navbar -->
  <nav class="navbar">
    <div class="navbar-brand">
      <h1>ğŸ“ Sistema de GestiÃ³n Educativa</h1>
    </div>
    <div class="navbar-menu">
      <div class="navbar-notifications">
        <span class="notification-badge" *ngIf="notificacionesSinLeer > 0">
          ğŸ”” <span class="badge-count">{{ notificacionesSinLeer }}</span>
        </span>
      </div>
      <div class="navbar-user">
        <span class="user-name" *ngIf="usuario">ğŸ‘¤ {{ usuario.nombre }} {{ usuario.apellido }}</span>
        <span class="user-role" *ngIf="usuario" [class.role-admin]="esAdmin()" [class.role-profesor]="esProfesor()" [class.role-estudiante]="esEstudiante()">
          {{ usuario.rol | uppercase }}
        </span>
      </div>
      <button class="btn btn-logout" (click)="logout()">ğŸšª Cerrar SesiÃ³n</button>
    </div>
  </nav>

  <!-- Contenido Principal -->
  <div class="dashboard-content">
    <div class="container">
      <!-- Header con bienvenida -->
      <div class="welcome-header">
        <h2>Â¡Bienvenido/a, {{ usuario?.nombre }}! ğŸ‘‹</h2>
        <p class="subtitle">{{ esAdmin() ? 'Panel de AdministraciÃ³n' : esProfesor() ? 'Panel de Profesor' : 'Panel de Estudiante' }}</p>
      </div>

      <!-- EstadÃ­sticas en Cards -->
      <div class="stats-grid">
        <div class="stat-card" *ngFor="let stat of estadisticas" [style.border-left-color]="stat.color">
          <div class="stat-icon">{{ stat.icono }}</div>
          <div class="stat-content">
            <span class="stat-titulo">{{ stat.titulo }}</span>
            <span class="stat-valor">{{ stat.valor }}</span>
            <span class="stat-tendencia" *ngIf="stat.tendencia">{{ stat.tendencia }}</span>
          </div>
        </div>
      </div>

      <div class="main-grid">
        <!-- Columna Izquierda -->
        <div class="left-column">
          <!-- Notificaciones -->
          <div class="card notifications-card">
            <div class="card-header">
              <h3>ğŸ”” Notificaciones</h3>
              <span class="badge-count" *ngIf="notificacionesSinLeer > 0">{{ notificacionesSinLeer }} nuevas</span>
            </div>
            <div class="notifications-list">
              <div class="notification-item" 
                   *ngFor="let notif of notificaciones.slice(0, 5)" 
                   [class.unread]="!notif.leida"
                   [class.notification-info]="notif.tipo === 'info'"
                   [class.notification-warning]="notif.tipo === 'warning'"
                   [class.notification-success]="notif.tipo === 'success'"
                   [class.notification-error]="notif.tipo === 'error'"
                   (click)="marcarNotificacionLeida(notif.id)">
                <div class="notification-icon">{{ notif.tipo === 'warning' ? 'âš ï¸' : notif.tipo === 'success' ? 'âœ…' : notif.tipo === 'error' ? 'âŒ' : 'â„¹ï¸' }}</div>
                <div class="notification-content">
                  <strong>{{ notif.titulo }}</strong>
                  <p>{{ notif.mensaje }}</p>
                  <span class="notification-time">{{ getTiempoTranscurrido(notif.fecha) }}</span>
                </div>
              </div>
              <div class="empty-state" *ngIf="notificaciones.length === 0">
                <p>ğŸ“­ No tienes notificaciones</p>
              </div>
            </div>
          </div>

          <!-- Actividad Reciente -->
          <div class="card activity-card">
            <div class="card-header">
              <h3>ğŸ“Š Actividad Reciente</h3>
            </div>
            <div class="activity-list">
              <div class="activity-item" *ngFor="let actividad of actividadesRecientes.slice(0, 6)">
                <div class="activity-timeline"></div>
                <div class="activity-content">
                  <p>{{ actividad.descripcion }}</p>
                  <span class="activity-time">{{ getTiempoTranscurrido(actividad.fecha) }}</span>
                </div>
              </div>
              <div class="empty-state" *ngIf="actividadesRecientes.length === 0">
                <p>ğŸ“ No hay actividad reciente</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Columna Derecha -->
        <div class="right-column">
          <!-- Cursos Activos / Accesos RÃ¡pidos -->
          <div class="card quick-actions-card" *ngIf="esAdmin()">
            <div class="card-header">
              <h3>âš¡ Accesos RÃ¡pidos</h3>
            </div>
            <div class="quick-actions-grid">
              <a routerLink="/usuarios" class="quick-action-item">
                <span class="action-icon">ğŸ‘¥</span>
                <span class="action-title">Usuarios</span>
                <span class="action-subtitle">Gestionar</span>
              </a>
              <a routerLink="/cursos" class="quick-action-item">
                <span class="action-icon">ğŸ“š</span>
                <span class="action-title">Cursos</span>
                <span class="action-subtitle">Administrar</span>
              </a>
              <a routerLink="/reportes" class="quick-action-item">
                <span class="action-icon">ğŸ“ˆ</span>
                <span class="action-title">Reportes</span>
                <span class="action-subtitle">Ver estadÃ­sticas</span>
              </a>
              <button class="quick-action-item" style="border: none; background: transparent; cursor: pointer;">
                <span class="action-icon">âš™ï¸</span>
                <span class="action-title">ConfiguraciÃ³n</span>
                <span class="action-subtitle">Sistema</span>
              </button>
            </div>
          </div>

          <div class="card courses-card" *ngIf="esProfesor() || esEstudiante()">
            <div class="card-header">
              <h3>ğŸ“š {{ esProfesor() ? 'Mis Cursos' : 'Cursos Inscritos' }}</h3>
              <a routerLink="/cursos" class="view-all-link">Ver todos â†’</a>
            </div>
            <div class="courses-list">
              <div class="course-item" *ngFor="let curso of cursosActivos">
                <div class="course-icon">ğŸ“–</div>
                <div class="course-info">
                  <strong>{{ curso.nombre }}</strong>
                  <p>{{ curso.descripcion }}</p>
                  <div class="course-progress" *ngIf="esEstudiante()">
                    <div class="progress-bar">
                      <div class="progress-fill" [style.width]="curso.descripcion.includes('65%') ? '65%' : curso.descripcion.includes('80%') ? '80%' : '45%'"></div>
                    </div>
                  </div>
                  <div class="course-students" *ngIf="esProfesor()">
                    <span>ğŸ‘¨â€ğŸ“ {{ curso.descripcion }}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- GrÃ¡fico de Actividad Semanal -->
          <div class="card chart-card" *ngIf="esAdmin() || esProfesor()">
            <div class="card-header">
              <h3>ğŸ“Š Actividad Semanal</h3>
            </div>
            <div class="chart-container">
              <div class="bar-chart">
                <div class="bar-item" *ngFor="let valor of actividadSemanal; let i = index">
                  <div class="bar" [style.height.%]="(valor / 30) * 100">
                    <span class="bar-value">{{ valor }}</span>
                  </div>
                  <span class="bar-label">{{ diasSemana[i] }}</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Tareas Pendientes para Estudiantes -->
          <div class="card tasks-card" *ngIf="esEstudiante()">
            <div class="card-header">
              <h3>ğŸ“ PrÃ³ximas Entregas</h3>
            </div>
            <div class="tasks-list">
              <div class="task-item">
                <div class="task-checkbox">â˜</div>
                <div class="task-info">
                  <strong>Componentes Reactivos</strong>
                  <p>Angular Avanzado â€¢ Vence en 2 dÃ­as</p>
                </div>
              </div>
              <div class="task-item">
                <div class="task-checkbox">â˜</div>
                <div class="task-info">
                  <strong>Decoradores TypeScript</strong>
                  <p>TypeScript Fundamentals â€¢ Vence en 5 dÃ­as</p>
                </div>
              </div>
              <div class="task-item completed">
                <div class="task-checkbox">â˜‘</div>
                <div class="task-info">
                  <strong>Operadores RxJS</strong>
                  <p>RxJS Reactive â€¢ Completado</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
